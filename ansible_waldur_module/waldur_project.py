#!/usr/bin/python
#
# THIS FILE IS AUTOGENERATED BY THE ANSIBLE MODULE GENERATOR - DO NOT EDIT
#
from ansible.module_utils.basic import AnsibleModule
from ansible_waldur_generator.plugins.crud.runner import CrudResourceRunner
from waldur_api_client.api.customers import customers_list
from waldur_api_client.api.customers import customers_retrieve
from waldur_api_client.api.project_types import project_types_list
from waldur_api_client.api.project_types import project_types_retrieve
from waldur_api_client.api.projects import projects_create
from waldur_api_client.api.projects import projects_destroy
from waldur_api_client.api.projects import projects_list
from waldur_api_client.models.project_request import ProjectRequest

ANSIBLE_METADATA = {
    "metadata_version": "1.1",
    "status": ["preview"],
    "supported_by": "OpenNode",
}

DOCUMENTATION = """
---
module: waldur_project
short_description: Manage Projects in Waldur.
version_added: '0.1'
description:
- Manage Projects in Waldur.
requirements:
- python = 3.11
- waldur-api-client
options:
  access_token:
    description: An access token.
    required: true
    type: str
  api_url:
    description: Fully qualified URL to the API.
    required: true
    type: str
  state:
    description: Should the resource be present or absent.
    choices:
    - present
    - absent
    type: str
    required: false
  name:
    type: str
    required: true
    description: The name of the project to check/create/delete.
  customer:
    type: str
    required: true
    description: The name or UUID of the customer.
  description:
    type: str
    required: false
    description: ''
  type:
    type: str
    required: false
    description: The name or UUID of the type.
  backend_id:
    type: str
    required: false
    description: ''
  start_date:
    type: str
    required: false
    description: ''
  end_date:
    type: str
    required: false
    description: The date is inclusive. Once reached, all project resource will be
      scheduled for termination.
  oecd_fos_2007_code:
    type: str
    required: false
    description: ''
    choices:
    - '1.1'
    - '1.2'
    - '1.3'
    - '1.4'
    - '1.5'
    - '1.6'
    - '1.7'
    - '2.1'
    - '2.2'
    - '2.3'
    - '2.4'
    - '2.5'
    - '2.6'
    - '2.7'
    - '2.8'
    - '2.9'
    - '2.10'
    - '2.11'
    - '2.12'
    - '3.1'
    - '3.2'
    - '3.3'
    - '3.4'
    - '3.5'
    - '4.1'
    - '4.2'
    - '4.3'
    - '4.4'
    - '4.5'
    - '5.1'
    - '5.2'
    - '5.3'
    - '5.4'
    - '5.5'
    - '5.6'
    - '5.7'
    - '5.8'
    - '5.9'
    - '6.1'
    - '6.2'
    - '6.3'
    - '6.4'
    - '6.5'
    - ''
  is_industry:
    type: bool
    required: false
    description: ''
  image:
    type: str
    required: false
    description: ''
"""

EXAMPLES = """
- name: Create a new project.
  hosts: localhost
  tasks:
  - name: Add project
    waldur_project:
      access_token: some_value
      api_url: some_value
      state: present
      name: My Awesome Project
      customer: Customer Name or UUID
- name: Remove an existing project.
  hosts: localhost
  tasks:
  - name: Remove project
    waldur_project:
      access_token: b83557fd8e2066e98f27dee8f3b3433cdc4183ce
      api_url: https://waldur.example.com:8000/api
      state: absent
      name: My Awesome Project
"""

ARGUMENT_SPEC = {
    "access_token": {"type": "str", "required": True},
    "api_url": {"type": "str", "required": True},
    "state": {"type": "str", "required": False, "choices": ["present", "absent"]},
    "name": {"type": "str", "required": True},
    "customer": {"type": "str", "required": True},
    "description": {"type": "str", "required": False},
    "type": {"type": "str", "required": False},
    "backend_id": {"type": "str", "required": False},
    "start_date": {"type": "str", "required": False},
    "end_date": {"type": "str", "required": False},
    "oecd_fos_2007_code": {
        "type": "str",
        "required": False,
        "choices": [
            "1.1",
            "1.2",
            "1.3",
            "1.4",
            "1.5",
            "1.6",
            "1.7",
            "2.1",
            "2.2",
            "2.3",
            "2.4",
            "2.5",
            "2.6",
            "2.7",
            "2.8",
            "2.9",
            "2.10",
            "2.11",
            "2.12",
            "3.1",
            "3.2",
            "3.3",
            "3.4",
            "3.5",
            "4.1",
            "4.2",
            "4.3",
            "4.4",
            "4.5",
            "5.1",
            "5.2",
            "5.3",
            "5.4",
            "5.5",
            "5.6",
            "5.7",
            "5.8",
            "5.9",
            "6.1",
            "6.2",
            "6.3",
            "6.4",
            "6.5",
            "",
        ],
    },
    "is_industry": {"type": "bool", "required": False},
    "image": {"type": "str", "required": False},
}

RUNNER_CONTEXT = {
    "resource_type": "project",
    "existence_check_func": projects_list,
    "present_create_func": projects_create,
    "present_create_model_class": ProjectRequest,
    "absent_destroy_func": projects_destroy,
    "absent_destroy_path_param": "uuid",
    "model_param_names": [
        "name",
        "customer",
        "description",
        "type",
        "backend_id",
        "start_date",
        "end_date",
        "oecd_fos_2007_code",
        "is_industry",
        "image",
    ],
    "resolvers": {
        "customer": {
            "list_func": customers_list,
            "retrieve_func": customers_retrieve,
            "error_message": "Customer '{value}' not found.",
        },
        "type": {
            "list_func": project_types_list,
            "retrieve_func": project_types_retrieve,
            "error_message": "Type '{value}' not found.",
        },
    },
}


def main():
    module = AnsibleModule(
        argument_spec=ARGUMENT_SPEC,
        supports_check_mode=True,
    )
    runner = CrudResourceRunner(module, RUNNER_CONTEXT)
    runner.run()


if __name__ == "__main__":
    main()
